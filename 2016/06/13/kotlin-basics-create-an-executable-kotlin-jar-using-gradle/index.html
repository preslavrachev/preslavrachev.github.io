<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Kotlin Basics: Create Executable Kotlin JARs, using Gradle</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=f593a58c15" />

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="http://www.preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="http://www.preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/amp/" />
    
    <meta property="og:site_name" content="Preslav&#x27;s Thoughts and Ramblings" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Kotlin Basics: Create Executable Kotlin JARs, using Gradle" />
    <meta property="og:description" content="Kotlin is great for creating small command-line utilities, which can be packaged and distributed as normal JAR files. This short tutorial will show you how to: Set up a Gradle project that supports Kotlin Add a starting function Configure your build to call this function when you execute your JAR." />
    <meta property="og:url" content="http://www.preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/" />
    <meta property="article:published_time" content="2016-06-13T19:09:53.000Z" />
    <meta property="article:modified_time" content="2016-07-16T05:04:47.000Z" />
    <meta property="article:tag" content="Kotlin" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Kotlin Basics: Create Executable Kotlin JARs, using Gradle" />
    <meta name="twitter:description" content="Kotlin is great for creating small command-line utilities, which can be packaged and distributed as normal JAR files. This short tutorial will show you how to: Set up a Gradle project that supports Kotlin Add a starting function Configure your build to call this function when you execute your JAR." />
    <meta name="twitter:url" content="http://www.preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Preslav Rachev" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Kotlin" />
    <meta name="twitter:site" content="@preslavrachev" />
    <meta name="twitter:creator" content="@preslavrachev" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Preslav&#x27;s Thoughts and Ramblings",
        "logo": {
            "@type": "ImageObject",
            "url": "http://www.preslav.me/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Preslav Rachev",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/fd47e6bba1f42ecacf2e7af9e4c5fb52?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://www.preslav.me/author/preslav/",
        "sameAs": [
            "https://twitter.com/preslavrachev"
        ]
    },
    "headline": "Kotlin Basics: Create Executable Kotlin JARs, using Gradle",
    "url": "http://www.preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/",
    "datePublished": "2016-06-13T19:09:53.000Z",
    "dateModified": "2016-07-16T05:04:47.000Z",
    "keywords": "Kotlin",
    "description": "Kotlin is great for creating small command-line utilities, which can be packaged and distributed as normal JAR files. This short tutorial will show you how to: Set up a Gradle project that supports Kotlin Add a starting function Configure your build to call this function when you execute your JAR.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://www.preslav.me/"
    }
}
    </script>

    <script type="text/javascript" src="/public/ghost-sdk.min.js?v=f593a58c15"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "69f974d18b04"
});
</script>
    <meta name="generator" content="Ghost 1.10" />
    <link rel="alternate" type="application/rss+xml" title="Preslav&#x27;s Thoughts and Ramblings" href="http://www.preslav.me/rss/" />
    <meta name="google-site-verification" content="VMxZ-AarPGjZ4X9IF5BEDXBi0hhGaj-S_Y_dj8WaAOE" />

<style>
    #disqus_thread {
        width: 80%;
        max-width: 710px;
        margin: 3rem auto 0;
    }
    
    #hellobar-bar .hb-close-wrapper {
    	display: block #important;
	}
</style>

</head>
<body class="post-template tag-kotlin">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="http://www.preslav.me">Preslav&#x27;s Thoughts and Ramblings</a>
            <ul class="nav">
    <li class="nav-home" role="presentation"><a href="http://www.preslav.me">Home</a></li>
    <li class="nav-micro" role="presentation"><a href="http://micro.preslav.me/">Micro</a></li>
    <li class="nav-about-me" role="presentation"><a href="http://www.preslav.me/about-me/">About Me</a></li>
    <li class="nav-my-work" role="presentation"><a href="http://www.preslav.me/work/">My Work</a></li>
    <li class="nav-contact" role="presentation"><a href="http://www.preslav.me/contact/">Contact</a></li>
</ul>
    </div>
    <div class="site-nav-right">
        <div class="social-links">
                <a class="social-link social-link-tw" href="https://twitter.com/preslavrachev" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
        </div>
            <a class="subscribe-button" href="#subscribe">Subscribe</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-kotlin no-image">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2016-06-13">13 June 2016</time>
                        <span class="date-divider">/</span> <a href="/tag/kotlin/">Kotlin</a>
                </section>
                <h1 class="post-full-title">Kotlin Basics: Create Executable Kotlin JARs, using Gradle</h1>
            </header>


            <section class="post-full-content">
                <div class="kg-card-markdown"><p>Kotlin is great for creating small command-line utilities, which can be packaged and distributed as normal JAR files. This short tutorial will show you how to:</p>
<ul>
<li>Set up a Gradle project that supports Kotlin</li>
<li>Add a starting function</li>
<li>Configure your build to call this function when you execute your JAR.</li>
</ul>
<h3 id="settingupkotlindependencies">Setting up Kotlin dependencies</h3>
<pre><code class="language-groovy">apply plugin: 'java'
apply plugin: 'kotlin'

//… other stuff, you typically find in a Gradle build file

dependencies {
     // other dependencies …
    compile &quot;org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version&quot;
}

buildscript {
     ext.kotlin_version = '1.0.2'
     //...
     compile &quot;org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version&quot;
}
</code></pre>
<p>You will also want your IDE (I assume you’re using IntelliJ or Android Studio) to mark the directory where your Kotlin source code resides as a source directory. Since Kotlin and Java are best friends, it is perfectly fine to keep the same package structure. It is a good practice though, to keep your Kotlin code physically separate from your Java one. Thus, you’d typically have two folders under <code>src</code> - <code>src/main/java</code> for Java classes, and <code>src/main/kotlin</code> for Kotlin ones. Same for tests. Again, in your <code>build.gradle</code> file, add the following:</p>
<pre><code class="language-groovy">sourceSets {
    main.java.srcDirs += 'src/main/kotlin/'
    test.java.srcDirs += 'src/test/kotlin/'
}
</code></pre>
<p>Using IntelliJ, you could rely not he IDE to guide you with all of this, but I wanted to show you the basics, since one may not always rely on the comfort of an IDE. To see that everything is working as it should, go to your project directory and create a new build:</p>
<pre><code class="language-bash">grade clean build
</code></pre>
<p>If everything has been set up correctly, you should be able to see a task named <code>compileKotlin</code> which the build has executed successfully.</p>
<h3 id="writeyourfirstkotlinprogram">Write your first Kotlin program</h3>
<p>Unlike Java, Kotlin is friendlier with functions that reside outside of any class scope. You can create a <code>Main</code> class hosting a <code>main()</code> function, or you can create a top-level <code>main()</code> without necessarily wrapping it in a class. Perhaps, you wouldn't be able to find any difference in a such a brief examaple, but I find the possibility to create top-level functions helpful in reducing boilerplate code.</p>
<p>Here is the mandatory HelloWorld example. Create a file with an arbitrary name (say <code>Main</code>) and an extension <code>.kt</code>, and write simply:</p>
<pre><code class="language-groovy">fun main(args : Array&lt;String&gt;) { 
  println(&quot;Hello, world!&quot;) 
}
</code></pre>
<p>Note that adding a package is optional, as well as ending your lines with semicolons. In order to keep consistency with my Java code though, I'd usually add both, and expect that people I work with, do the same.</p>
<h3 id="configureyourgradlebuildtocreateanexecutablejar">Configure your Gradle build to create an executable JAR</h3>
<p>The <code>main</code> function we just added, is enough to test setting up an executable JAR, which one should then be able to call simply by executing:</p>
<pre><code class="language-bash">java -jar &lt;MY_PROJECT_NAME&gt;.jar
</code></pre>
<p>If you simply try to build your project and then execute the above command, we would get the following message:</p>
<pre><code class="language-bash">no main manifest attribute &lt;PATH_TO_MY_PROJECT_JAR&gt;.jar
</code></pre>
<p>This means that we have to configure <code>jar</code> task, which Java Gradle builds go through, and tell it which the starting point of our project is. In a Java project, this would be the path to the class where our <code>main()</code> function resides:</p>
<pre><code class="language-groovy">jar {
    manifest {
        attributes 'Main-Class': 'com.myname.myprojectname.Main'
    }
}
</code></pre>
<p>Wait a minute? We have defined our <code>main()</code> function outisde of any class scope. That's true and not entirely true at the same time. Actually, to keep things at the bytecode level consistent, and backwards-compatible with the JVM, the Kotlin compiler adds all top-level functions to respective classes. In our case, the class generated by the Kotlin compiler would have the same name the filename of the file where our function resides, plus the suffix <code>Kt</code>. This means, for example, that if our file is called <code>Main.kt</code>, the Kotlin compiler would generate a class with the name <code>MainKt.class</code> and add it to the generated JAR file. Knowing this, one could rewrite the Gradle configuration above, as follows:</p>
<pre><code class="language-groovy">jar {
    manifest {
        attributes 'Main-Class': 'com.myname.myprojectname.MainKt'
    }
}
</code></pre>
<p><strong>Note:</strong> You can specifiy the name this class should be compiled with, by adding a file-scope annotation on top of your file, even before the <code>package</code> decalration:</p>
<pre><code class="language-kotlin">@file:JvmName(&quot;MainCls&quot;)
</code></pre>
<p>This new name can be used within the JAR manifest configuration, as shown above.</p>
<p>Even though we specified our main class correctly in our JAR manifest configuration, if we try to execute our main function using <code>jar -jar</code>, we will still see an error message:</p>
<pre><code class="language-bash">Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: kotlin/jvm/internal/Intrinsics
	at com.preslavrachev.imdbparser.MainKt.main(Main.kt)
Caused by: java.lang.ClassNotFoundException: kotlin.jvm.internal.Intrinsics
	at java.net.URLClassLoader.findClass(URLClassLoader.java:381)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:424)
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:357)
	... 1 more
</code></pre>
<p>Experienced Java developers will quickly recognize this type of exception. By default when Gradle (as well as Maven) packs some Java class files into a JAR file, it is assumed that this JAR file will be referenced by an application, where all of its dependencies are also accessible within the classpath of the loading application. To execute a JAR without having to specifiy the path to itse dependencies, one must tell the build system to take all of this JAR's referenced dependencies and copy them as part of the JAR itself. In the Java community, this is known as a &quot;fat JAR&quot;. In a &quot;fat JAR&quot; all of the dependencies end up within the class path of the loading application, so code can be executed without problems. The only downside to creating fat JARs is of course their growing file size (which kind of explains the name), though in most situations, it is not a big concern. In order to tell Gradle to copy all of a JAR's dependencies, one should simply modify the abovementioned JAR task configuration, by adding the following piece of code:</p>
<pre><code class="language-groovy">jar {
    manifest {
        attributes 'Main-Class': 'com.preslavrachev.imdbparser.MainKt'
    }

    // This line of code recursively collects and copies all of a project's files
    // and adds them to the JAR itself. One can extend this task, to skip certain 
    // files or particular types at will
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
}
</code></pre>
<h3 id="furtherlinks">Further Links</h3>
<ul>
<li><a href="http://www.mkyong.com/gradle/gradle-create-a-jar-file-with-dependencies/">Gradle – Create a Jar file with dependencies</a></li>
<li><a href="http://stackoverflow.com/questions/21721119/creating-runnable-jar-with-gradle">Creating runnable JAR with Gradle | StackOverflow</a></li>
</ul>
</div>
            </section>

            <section class="subscribe-form">
                <h3 class="subscribe-form-title">Subscribe to Preslav&#x27;s Thoughts and Ramblings</h3>
                <p>Get the latest posts delivered right to your inbox</p>
                <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit"><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>


            </section>

            <footer class="post-full-footer">

                <section class="author-card">
                        <img class="author-profile-image" src="//www.gravatar.com/avatar/fd47e6bba1f42ecacf2e7af9e4c5fb52?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Preslav Rachev" />
                    <section class="author-card-content">
                        <h4 class="author-card-name"><a href="/">Preslav Rachev</a></h4>
                            <p>Read <a href="/">more posts</a> by this author.</p>
                    </section>
                </section>
                <div class="post-full-footer-right">
                    <a class="author-card-button" href="/">Read More</a>
                </div>

            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
                <article class="read-next-card"
                        style="background-image: url(https://www.dropbox.com/s/qvwn6s7qm1j69jt/kotlin-collection-cover.jpg?raw&#x3D;1)"
                >
                    <header class="read-next-card-header">
                        <small class="read-next-card-header-sitetitle">&mdash; Preslav&#x27;s Thoughts and Ramblings &mdash;</small>
                        <h3 class="read-next-card-header-title"><a href="/tag/kotlin/">Kotlin</a></h3>
                    </header>
                    <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                    <div class="read-next-card-content">
                        <ul>
                            <li><a href="/2018/03/19/weekly-notes-2/">Weekly Notes</a></li>
                            <li><a href="/2018/03/18/platform-types-in-kotlin/">Platform Types in Kotlin</a></li>
                            <li><a href="/2018/02/18/weekly-notes-feb-13-feb-19-2018/">Weekly Notes (Feb 13th / Feb 19th, 2018)</a></li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="/tag/kotlin/">See all 6 posts →</a>
                    </footer>
                </article>

                <article class="post-card post tag-tip tag-github tag-stackoverflow tag-ergonomics no-image">
    <div class="post-card-content">
        <a class="post-card-content-link" href="/2016/06/19/dev-ergonomics-tip-use-a-dark-style-github-stackoverflow-theme/">
            <header class="post-card-header">
                    <span class="post-card-tags">tip</span>
                <h2 class="post-card-title">Dev Ergonomics Tip: Use a Dark-Style GitHub/StackOverflow Theme</h2>
            </header>
            <section class="post-card-excerpt">
                <p>As many of the developers I know and have met, I am also used to using a dark colour theme on all of my IDEs and text editors, and the command-line terminal. In</p>
            </section>
        </a>
        <footer class="post-card-meta">
                <img class="author-profile-image" src="//www.gravatar.com/avatar/fd47e6bba1f42ecacf2e7af9e4c5fb52?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Preslav Rachev" />
            <span class="post-card-author"><a href="/author/preslav/">Preslav Rachev</a></span>
        </footer>
    </div>
</article>

                <article class="post-card post tag-kotlin no-image">
    <div class="post-card-content">
        <a class="post-card-content-link" href="/2016/05/29/kotlin-tips-named-parameters-default-arguments/">
            <header class="post-card-header">
                    <span class="post-card-tags">Kotlin</span>
                <h2 class="post-card-title">Kotlin Basics: Named Parameters and Default Arguments</h2>
            </header>
            <section class="post-card-excerpt">
                <p>Named parameters and default parameter values Similar to their equivalents in Python and Scala, functions in Kotlin can have named parameters and default parameter values. This makes it easy to provide an arbitrary</p>
            </section>
        </a>
        <footer class="post-card-meta">
                <img class="author-profile-image" src="//www.gravatar.com/avatar/fd47e6bba1f42ecacf2e7af9e4c5fb52?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Preslav Rachev" />
            <span class="post-card-author"><a href="/author/preslav/">Preslav Rachev</a></span>
        </footer>
    </div>
</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="http://www.preslav.me">
            <span>Preslav&#x27;s Thoughts and Ramblings</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">Kotlin Basics: Create Executable Kotlin JARs, using Gradle</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Kotlin%20Basics%3A%20Create%20Executable%20Kotlin%20JARs%2C%20using%20Gradle&amp;url=http://www.preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=http://www.preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="http://www.preslav.me">Preslav&#x27;s Thoughts and Ramblings</a> &copy; 2018</section>
                <nav class="site-footer-nav">
                    <a href="http://www.preslav.me">Latest Posts</a>
                    
                    <a href="https://twitter.com/preslavrachev" target="_blank">Twitter</a>
                    <a href="https://ghost.org" target="_blank">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="#"></a>
        <div class="subscribe-overlay-content">
            <h1 class="subscribe-overlay-title">Subscribe to Preslav&#x27;s Thoughts and Ramblings</h1>
            <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
            <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit"><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>


        </div>
    </div>

    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js?v=f593a58c15"></script>


    <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>


    <!-- Matomo -->
<script type="text/javascript">
  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  setTimeout(function() {
    var u="//preslavrachev.innocraft.cloud/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  }, 5000);
</script>
<!-- End Matomo Code -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40565485-7', 'auto');
  ga('send', 'pageview');

</script>

<!-- disqus -->
<script>
    var article = $('.post-template main article');
    var disqusSite = 'preslav';
    if (article.length) {
        article.after('<div id="disqus_thread"></div>');
        (function() {
            var d = document, s = d.createElement('script');
            s.src = '//' + disqusSite + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    }
</script>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

</body>
</html>
